-------------------------------
  User-visible changes in ufw
-------------------------------

* v3.1.0 → v3.2.0 (released 2023-02-10):

** New Features

- test/tap: Add okx() variant of ok().
- Improve zephyr toolchain compatibility for zephyr 3.3.

** Diffstat:

    cmake/modules/SetupTargetCPU.cmake |  6 +++++-
    include/ufw/test/tap.h             |  2 ++
    src/test/tap.c                     | 15 +++++++++++----
    3 files changed, 18 insertions(+), 5 deletions(-)


* v3.0.0 → v3.1.0 (released 2023-01-12):

** New Features

- Add an errno compatibility layer. Instead of including ‘errno.h’, portable
  code should include ‘ufw/compat/errno.h’.
- Add octet-buffer data type.
- Add generic source and sink data types (collectively called endpoints).
- Add RFC1055 compliant SLIP codec, with optional start-of-frame delimiter
  support.
- Add variable-length integer encoding. This follows the specification for
  Google's protobuf; it implements 32/64 bit unsigned/signed integers.
- Add length-prefix framing, using 64 bit unsigned variable-length integer
  length specifiers.
- cmake, GitIntegration: Install via ‘ufw-git-install’ CMake component. This
  allows user to only install these artefacts if they so choose.

** Bugfixes

- Fix memdiff issue when there are differences in the last line of hexadecimal
  data.
- Implement ssize_t limit macros for toolchains (Texas Instruments), that do
  not implement this data type. This is an oversight at the time the typedef
  and the basic compatibility layer for the data type was introduced.

** Miscellaneous

- Documentation improvements.
- Slight restructuring of ‘src/’ directory without impact onto users.

** Diffstat:

    .dir-locals.el                                |   6 +
    .gitignore                                    |   6 +-
    CMakeLists.txt                                |  30 +-
    cmake/modules/GitIntegration.cmake            |   6 +-
    include/ufw/compat.h                          |   7 +
    include/ufw/compat/errno.h                    |  53 +++
    include/ufw/compat/math-constants.h           |   6 +
    include/ufw/compat/ssize-t.h                  |  26 +-
    include/ufw/compat/strings.h                  |   6 +
    include/ufw/endpoints.h                       | 149 +++++++
    include/ufw/length-prefix.h                   |  38 ++
    include/ufw/octet-buffer.h                    |  40 ++
    include/ufw/register-utilities.h              |   6 +
    include/ufw/rfc1055.h                         |  42 ++
    include/ufw/toolchain.h.in                    |  28 ++
    include/ufw/variable-length-integer.h         |  40 ++
    src/endpoints/buffer.c                        |  57 +++
    src/endpoints/core.c                          | 179 ++++++++
    src/endpoints/instrumentable.c                |  95 +++++
    src/endpoints/posix.c                         |  54 +++
    src/endpoints/trivial.c                       |  33 ++
    src/length-prefix.c                           | 173 ++++++++
    src/octet-buffer.c                            | 111 +++++
    src/persistent-storage.c                      | 136 ++++++
    src/{register-table.c => registers/core.c}    |   2 +-
    .../internal.h}                               |   0
    .../utilities.c}                              |   2 +-
    src/rfc1055.c                                 | 241 +++++++++++
    src/test/memdiff.c                            |  60 +--
    src/test/output-utils.c                       |   6 +
    src/variable-length-integer.c                 | 283 +++++++++++++
    test/CMakeLists.txt                           |   5 +-
    test/t-binary-format.c                        |   6 +
    test/t-length-prefix.c                        |  89 ++++
    test/t-persistent-storage.c                   |   6 +
    test/t-register-table-persistent-storage.c    |   8 +-
    test/t-register-table.c                       |   6 +
    test/t-rfc1055.c                              | 254 ++++++++++++
    test/t-varint.c                               | 386 ++++++++++++++++++
    39 files changed, 2639 insertions(+), 42 deletions(-)


* v2.1.0 → v3.0.0 (released 2022-09-21):

** Breaking compatibility

- Reorganise code-base:
  - cmake: ufw++ target removed.
  - cmake: ufw-common target removed.
  - code: Separation of c and c/c++ code removed.
  - code: All header files now have a consistent ‘ufw’ prefix.
    Examples:

    |--------------------+----------------------|
    | Old (pre-3.0)      | New (3.0 and newer)  |
    |--------------------+----------------------|
    | common/compiler.h  | ufw/compiler.h       |
    | c/compat/strings.h | ufw/compat/strings.h |
    | test/tap.h         | ufw/test/tap.h       |
    |--------------------+----------------------|

- The logger API was removed.


** New Features

- cmake: ufw-tap-nosan target added.
- register-table: Allow adding per-register user-specified data.
- register-table: Add user-specified initialisation API.


** Bugfixes

- Fix TI toolchain feature detection.
- Remove internal register API from public header path.
- register-table: Fix return code of functions encountering uninitialised
  register tables.


** Miscellaneous

- CMake minimum version increased to ‘3.13.4’.
- register-table: REG_* and REGx_* macros can now be generated.
- Some code was re-indented for consistency.


** Diffstat:

    CMakeLists.txt                             |  90 +++--
    LICENCE                                    |   2 +-
    cmake/modules/GNUBuiltins.cmake            |  23 +-
    doc/CMakeLists.txt                         |   2 +
    include/c/logger.h                         |  87 -----
    include/{c => ufw}/binary-format.h         |  10 +-
    include/{common => ufw}/bit-operations.h   |   8 +-
    include/{c => ufw}/compat.h                |  14 +-
    include/{c => ufw}/compat/math-constants.h |   8 +-
    include/{c => ufw}/compat/ssize-t.h        |   8 +-
    include/{c => ufw}/compat/strings.h        |   8 +-
    include/{common => ufw}/compiler.h         |  10 +-
    include/{c => ufw}/convolution-low-pass.h  |   8 +-
    include/{c => ufw}/persistent-storage.h    |   8 +-
    include/{c => ufw}/register-table.h        | 215 +++++++----
    include/{c => ufw}/register-utilities.h    |   8 +-
    include/{c => ufw}/ring-buffer-iter.h      |  10 +-
    include/{c => ufw}/ring-buffer.h           |   8 +-
    include/{ => ufw}/test/tap.h               |   9 +-
    include/{common => ufw}/toolchain.h.in     |   0
    scheme/ufw/register-table.scm              |  91 +++++
    scheme/ufw/utilities.scm                   |  23 ++
    src/c/logger.c                             | 175 ---------
    src/{c => compat}/strlcat.c                |   4 +-
    src/{c => compat}/strlcpy.c                |   4 +-
    src/{c => compat}/strnlen.c                |   5 +-
    src/{c => }/persistent-storage.c           |  23 +-
    {include/c => src}/register-internal.h     |  10 +-
    src/{c => }/register-table.c               |  69 +++-
    src/{c => }/register-utilities.c           |  19 +-
    src/{c => }/ring-buffer-iter.c             |   4 +-
    src/test/memdiff.c                         |  10 +-
    src/test/output-utils.c                    |   6 +-
    src/test/tap.c                             |   8 +-
    target/cortex-m3/init/startup.c            |   4 +-
    target/cortex-m3/ld/arm-cortex-qemu.ld     |   2 +-
    test/CMakeLists.txt                        |   2 +-
    test/t-binary-format.c                     |   6 +-
    test/t-convolution-low-pass.c              |   8 +-
    test/t-persistent-storage.c                |   6 +-
    test/t-register-table-persistent-storage.c | 423 +++++++++++----------
    test/t-register-table.c                    |  41 +-
    test/t-ring-buffer.c                       |  10 +-
    tools/make-register-macros                 |  15 +
    tools/make-register-macros.scm             |  72 ++++
    45 files changed, 853 insertions(+), 723 deletions(-)


* v2.0.1 → v2.1.0 (released 2022-06-25):

** New Features

- Add support for draw.io graphics in GenerateGraphics.cmake.

** Diffstat:

    cmake/modules/GenerateGraphics.cmake | 18 +++++++++++++++++-
    1 file changed, 17 insertions(+), 1 deletion(-)


* v2.0.0 → v2.0.1 (released 2022-06-24):

** Bugfixes

- Handle ufwz inclusion like any other zephyr module.
- Parenthesise macro arguments more pedantically in BIT*_GET().

** Diffstat:

    include/common/bit-operations.h | 6 +++---
    module.yaml                     | 2 ++
    2 files changed, 5 insertions(+), 3 deletions(-)


* v1.0.0 → v2.0.0 (released 2022-06-03):

** Breaking compatibility

- Remove support for recursive cmake building schemes. This is the big one. See
  the commit message for 8796e9a9d for a rationale. Similar build schemes can
  be achieved using mmh v0.11 and newer.
- artefacts: Do not include DetachedHead in versioned file names.
- artefacts: Drop _vNoVersion if no version tag was found.

** New Features

- Experimental support for selecting from multiple clang toolchain versions.
- register-table: Add ‘register_address()’ API.
- register-table: Add ‘register_get_entry()’ API.
- register-table: Allow swapping out printing routines.
- register-table: Add support for printing register values and validators.
- modules: Add inclusion rule for lwgps module.

** Bugfixes

- xilinx-ise: Disable async_to_sync. This was set by mistake.
- Fix compilation with newer newlib versions (3.3.0 in particular).

** Miscellaneous

- Added integration tests for register-table and persistent-storage.
- Improve register-table initialisation error detection capabilities.

** Diffstat:

    .gitignore                                    |   1 +
    AUTHORS                                       |   1 +
    CMakeLists.txt                                |   9 +-
    bin/generate-artifacts                        |  11 +-
    cmake/modules/BuildInTargetDir.cmake          |  33 --
    cmake/modules/BuildInZephyrDir.cmake          | 289 -----------------
    cmake/modules/SetupUFW.cmake                  | 178 +----------
    cmake/toolchains/clang.cmake                  |  45 ++-
    .../xilinx-ise/xst/synthesis_script.xst.in    |   2 +-
    include/c/register-table.h                    |  12 +-
    include/c/register-utilities.h                |  14 +-
    module.yaml                                   |   2 +
    src/c/register-table.c                        |  10 +
    src/c/register-utilities.c                    | 227 +++++++++----
    test/CMakeLists.txt                           |   3 +-
    test/t-register-table-persistent-storage.c    | 297 ++++++++++++++++++
    test/t-register-table.c                       |  23 +-
    17 files changed, 584 insertions(+), 573 deletions(-)


* scratch → v1.0.0 (released 2021-08-14):

** Miscellaneous

- First system release from scratch.

** Diffstat:

    .clang-format                                 |   89 +
    .gitignore                                    |   29 +
    AUTHORS                                       |    9 +
    CMakeLists.txt                                |  120 +
    HACKING                                       |   94 +
    LICENCE                                       |   25 +
    README                                        |   42 +
    bin/generate-artifacts                        |   98 +
    bin/generate-version-h                        |  198 ++
    bin/print-commitdate                          |   16 +
    bin/print-version                             |   16 +
    cmake/kconfig/README                          |   16 +
    cmake/kconfig/debug.conf                      |    4 +
    cmake/kconfig/minsizerel.conf                 |    4 +
    cmake/kconfig/release.conf                    |    4 +
    cmake/kconfig/relwithdebinfo.conf             |    4 +
    cmake/modules/ArmCmsis.cmake                  |   10 +
    cmake/modules/BuildArtifacts.cmake            |  166 ++
    cmake/modules/BuildInTargetDir.cmake          |   33 +
    cmake/modules/BuildInZephyrDir.cmake          |  289 ++
    cmake/modules/FakeTimeSupport.cmake           |   18 +
    cmake/modules/FreeRTOS.cmake                  |  101 +
    cmake/modules/GNUAttributes.cmake             |  183 ++
    cmake/modules/GNUBuiltins.cmake               |   59 +
    cmake/modules/GNUCompilerWarnings.cmake       |  171 ++
    cmake/modules/GenerateGraphics.cmake          |  161 ++
    cmake/modules/GitIntegration.cmake            |  210 ++
    cmake/modules/HardwareAbstraction.cmake       |   81 +
    cmake/modules/InitialiseToolchain.cmake       |  222 ++
    cmake/modules/Libtap.cmake                    |   25 +
    cmake/modules/Newlib.cmake                    |   16 +
    cmake/modules/STCmsis.cmake                   |   14 +
    cmake/modules/STM32HAL.cmake                  |   59 +
    cmake/modules/STM32HAL_f0.cmake               |   69 +
    cmake/modules/STM32HAL_f1.cmake               |   68 +
    cmake/modules/STM32HAL_f2.cmake               |   74 +
    cmake/modules/STM32HAL_f3.cmake               |   80 +
    cmake/modules/STM32HAL_f4.cmake               |   97 +
    cmake/modules/STM32HAL_f7.cmake               |   97 +
    cmake/modules/STM32HAL_g0.cmake               |   70 +
    cmake/modules/STM32HAL_g4.cmake               |   91 +
    cmake/modules/STM32HAL_h7.cmake               |  123 +
    cmake/modules/STM32HAL_l0.cmake               |   73 +
    cmake/modules/STM32HAL_l1.cmake               |   67 +
    cmake/modules/STM32HAL_l4.cmake               |  112 +
    cmake/modules/STM32HAL_l5.cmake               |  100 +
    cmake/modules/STM32HAL_wb.cmake               |   77 +
    cmake/modules/SetupTargetCPU.cmake            |  131 +
    cmake/modules/SetupUFW.cmake                  |  221 ++
    cmake/modules/TICompilerWarnings.cmake        |   69 +
    cmake/modules/ToolchainFeatures.cmake         |  114 +
    cmake/modules/UFWTest.cmake                   |  111 +
    cmake/modules/UFWTools.cmake                  |   96 +
    cmake/modules/XilinxISEToolchain.cmake        |  405 +++
    cmake/modules/pandocology.cmake               |  431 +++
    cmake/toolchains/clang-arm-none-eabi.cmake    |   21 +
    cmake/toolchains/clang.cmake                  |   42 +
    cmake/toolchains/gnu-arm-none-eabi.cmake      |   25 +
    cmake/toolchains/gnu.cmake                    |   27 +
    cmake/toolchains/ti-arm.cmake                 |   59 +
    cmake/toolchains/ti-c2000.cmake               |   65 +
    cmake/toolchains/xilinx-ise.cmake             |   31 +
    doc/CMakeLists.txt                            |   20 +
    doc/Doxyfile.in                               | 2484 +++++++++++++++++
    .../xilinx-ise/cmd/bitgen_command_file.cmd    |   29 +
    .../xilinx-ise/cmd/impact_program_jtag.cmd.in |    6 +
    .../xilinx-ise/cmd/map_command_file.cmd       |   15 +
    .../xilinx-ise/cmd/ngd_command_file.cmd       |    3 +
    .../xilinx-ise/cmd/par_command_file.cmd       |    3 +
    .../xilinx-ise/cmd/twr_command_file.cmd       |    4 +
    doc/examples/xilinx-ise/target.cmake          |   19 +
    .../xilinx-ise/tcl/process_properties.tcl     |  328 +++
    .../xilinx-ise/tcl/project_properties.tcl     |    9 +
    .../xilinx-ise/xst/synthesis_script.xst.in    |   55 +
    include/c/binary-format.h                     |  533 ++++
    include/c/compat.h                            |   18 +
    include/c/compat/math-constants.h             |   85 +
    include/c/compat/ssize-t.h                    |   52 +
    include/c/compat/strings.h                    |   31 +
    include/c/convolution-low-pass.h              |  139 +
    include/c/logger.h                            |   87 +
    include/c/persistent-storage.h                |  169 ++
    include/c/register-internal.h                 |   46 +
    include/c/register-table.h                    |  412 +++
    include/c/register-utilities.h                |   25 +
    include/c/ring-buffer-iter.h                  |   99 +
    include/c/ring-buffer.h                       |  192 ++
    include/common/bit-operations.h               |  354 +++
    include/common/compiler.h                     |  252 ++
    include/common/toolchain.h.in                 |  337 +++
    include/test/tap.h                            |   90 +
    module.yaml                                   |   33 +
    src/c/logger.c                                |  175 ++
    src/c/persistent-storage.c                    |  475 ++++
    src/c/register-table.c                        | 1469 ++++++++++
    src/c/register-utilities.c                    |  213 ++
    src/c/ring-buffer-iter.c                      |   48 +
    src/c/strlcat.c                               |   56 +
    src/c/strlcpy.c                               |   50 +
    src/c/strnlen.c                               |   31 +
    src/test/memdiff.c                            |  401 +++
    src/test/output-utils.c                       |   67 +
    src/test/tap.c                                |   99 +
    target/cortex-m3/bin/run                      |   25 +
    target/cortex-m3/init/startup.c               |  158 ++
    target/cortex-m3/ld/arm-cortex-qemu.ld        |  137 +
    test/.gitignore                               |   12 +
    test/CMakeLists.txt                           |   33 +
    test/t-binary-format.c                        |  676 +++++
    test/t-convolution-low-pass.c                 |  106 +
    test/t-persistent-storage.c                   |  122 +
    test/t-register-table.c                       |  988 +++++++
    test/t-ring-buffer.c                          |   61 +
    vcs-integration/build-information.sh          |   35 +
    vcs-integration/definitions.sh.example        |   12 +
    vcs-integration/git.sh                        |  250 ++
    vcs-integration/system-version.h.in           |  126 +
    vcs-integration/version.h.in                  |  170 ++
    118 files changed, 17556 insertions(+)
